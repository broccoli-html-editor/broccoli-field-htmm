window.main=new function(){var e;window.biflora&&(e=this.socket=window.biflora.createSocket(this,io,{showSocketTest:function(e,o,t,n){o(e)}}));var o="biflora",t=new Broccoli;this.broccoli=window.broccoli=t,this.init=function(n,i){i=i||function(){},(n=n||{}).serverType&&(o=n.serverType),t.init({elmCanvas:$(".canvas").get(0),elmModulePalette:$(".palette").get(0),contents_area_selector:"[data-contents]",contents_bowl_name_by:"data-contents",lang:"ja",appearance:"light",customFields:{htmm:window.BroccoliFieldHtmm},gpiBridge:function(t,n,i){console.info("=----= GPI Request =----=",t,n);var c=(new Date).getTime();if("biflora"==o)e.send("broccoli",{api:"gpiBridge",bridge:{api:t,options:n}},function(e){console.info("-- GPI result",(new Date).getTime()-c,e),i(e)});else if("php"==o){var s;$.ajax({url:"./_api.php",method:"post",data:{api:t,options:JSON.stringify(n)},success:function(e){try{s=JSON.parse(e)}catch(o){console.error(o,e)}},error:function(e){console.error(e)},complete:function(){console.info("-- GPI result",(new Date).getTime()-c,s),i(s)}})}}},function(){$(window).resize(function(){t.redraw()}),i()})},this.socketTest=function(){return e.send("socketTest",{message:"socketTest from frontend."},function(e){console.log(e)}),this}};